<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sign Up - Chapterless</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/remixicon@4.5.0/fonts/remixicon.css"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <link rel="stylesheet" href="/styles/signupPage.css" />
  </head>
  <body
    class="paper-texture d-flex align-items-center justify-content-center min-vh-100 py-3"
  >
    <div class="container">
      <div class="signup-container mx-auto bg-white row">
        <!-- Left image side -->
        <div class="col-md-5 p-0 image-side d-none d-md-block">
          <div class="overlay">
            <div class="text-white">
              <h2 class="h3 fw-bold mb-1">Where Stories Find Lost Souls</h2>
              <p class="mb-0 small">Join our literary journey today.</p>
            </div>
          </div>
        </div>

        <!-- Right form side -->
        <div class="col-12 col-md-7 form-side">
          <div class="text-center mb-3">
            <div class="d-flex align-items-center justify-content-center mb-2">
              <img
                src="https://readdy.ai/api/search-image?query=Minimalist%20black%20logo%20of%20stacked%20books%2C%20clean%20lines%2C%20simple%20geometric%20shapes%2C%20professional%20design%2C%20high%20contrast%2C%20vector%20style%2C%20transparent%20background&width=50&height=50&seq=123458&orientation=squarish"
                alt="Chapterless Logo"
                class="me-2"
                height="30"
              />
              <span class="logo-text fs-4">Chapterless</span>
            </div>
            <h2 class="fw-bold h4">Create an account</h2>
            <p class="text-muted small mb-3">
              Sign up to start your reading journey
            </p>
          </div>

          <form id="userSignup" method="post">
            <div class="compact-mb">
              <label for="fullName" class="form-label">Full Name</label>
              <input
                type="text"
                name="fullName"
                class="form-control form-control-sm"
                id="fullName"
                placeholder="Enter your full name"
              />
              <div id="fullNameError" class="text-danger small mt-1"></div>
            </div>
            <div class="compact-mb">
              <label for="email" class="form-label">Email Address</label>
              <input
                type="email"
                name="email"
                class="form-control form-control-sm"
                id="email"
                placeholder="Enter your email"
              />
              <div id="emailError" class="text-danger small mt-1"></div>
            </div>
            <div class="compact-mb">
              <label for="phoneNumber" class="form-label">Phone Number</label>
              <input
                type="tel"
                name="phoneNumber"
                class="form-control form-control-sm"
                id="phoneNumber"
                placeholder="Enter your phone number"
              />
              <div id="phoneNumberError" class="text-danger small mt-1"></div>
            </div>
            <div class="compact-mb">
              <label for="password" class="form-label">Password</label>
              <input
                type="password"
                name="password"
                class="form-control form-control-sm"
                id="password"
                placeholder="Create a password"
              />
              <div id="passwordError" class="text-danger small mt-1"></div>
            </div>
            <div class="compact-mb">
              <label for="confirmPassword" class="form-label"
                >Confirm Password</label
              >
              <input
                type="password"
                name="confirmPassword"
                class="form-control form-control-sm"
                id="confirmPassword"
                placeholder="Confirm your password"
              />
              <div
                id="confirmPasswordError"
                class="text-danger small mt-1"
              ></div>
            </div>

            <button
              type="submit"
              class="btn btn-primary btn-sm w-100 mb-2 py-2"
            >
              Sign Up
            </button>

            <div class="divider">
              <span>or</span>
            </div>

            <a href="/auth/google"
              type="button"
              class="btn btn-outline-secondary btn-sm w-100 mb-3 py-2"
            >
              <i class="ri-google-fill me-2"></i> Continue with Google
            </a>

            <div class="text-center">
              <p class="mb-0 small">
                Already have an account?
                <a href="#" class="text-decoration-none fw-medium">Log in</a>
              </p>
            </div>
          </form>
        </div>
      </div>

      <div class="text-center mt-2">
        <p class="text-muted small">
          &copy; 2025 Chapterless. All rights reserved.
        </p>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
         document
  .getElementById("userSignup")
  .addEventListener("submit", async (event) => {
    event.preventDefault();

    const fullName = document.getElementById("fullName").value.trim();
    const email = document.getElementById("email").value.trim();
    const phoneNumber = document.getElementById("phoneNumber").value.trim();
    const password = document.getElementById("password").value;
    const confirmPassword = document.getElementById("confirmPassword").value;

    
    document.getElementById("fullNameError").textContent = "";
    document.getElementById("emailError").textContent = "";
    document.getElementById("phoneNumberError").textContent = "";
    document.getElementById("passwordError").textContent = "";
    document.getElementById("confirmPasswordError").textContent = "";

    let isValid = true;

  
    if (!fullName) {
      document.getElementById("fullNameError").textContent = "Full name is required.";
      isValid = false;
    }

    if (!email || !/^\S+@\S+\.\S+$/.test(email)) {
      document.getElementById("emailError").textContent = "Valid email is required.";
      isValid = false;
    }

    if (!phoneNumber || !/^\d{10}$/.test(phoneNumber)) {
      document.getElementById("phoneNumberError").textContent = "Valid 10-digit phone number is required.";
      isValid = false;
    }

    if (!password || password.length < 6) {
      document.getElementById("passwordError").textContent = "Password must be at least 6 characters.";
      isValid = false;
    }

    if (password !== confirmPassword) {
      document.getElementById("confirmPasswordError").textContent = "Passwords do not match.";
      isValid = false;
    }

    if (isValid) {
      try {
        const response = await fetch("/signup", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            fullName,
            email,
            phoneNumber,
            password,
            confirmPassword 
          }),
        });

        const result = await response.json();
        console.log(result)

        if (result.success) {
          console.log(result)
          Swal.fire({
            icon: "success",
            title: "Signup Successful",
            text: "Welcome to Chapterless!",
            confirmButtonColor: "#3085d6",
            confirmButtonText: "Proceed to Login",
          }).then(()=>{
            window.location.href = '/verify-otp'
          })
        } else {
          Swal.fire({
            icon: "error",
            title: "Signup Failed",
            text: result.message || "Something went wrong!",
            
          });
        }
      } catch (err) {
        console.log("Signup error:", err);
        Swal.fire({
          icon: "error",
          title: "Error",
          text: result.message||"Server not responding. Try again later.",
        });
      }
    }
  });
    </script>
  </body>
</html>
